#!/bin/sh
#HOSTNAME=`env hostname`
echo "...starting magma in dir $(PWD)"

# export NODE_NAME=dev

# # riak_core settings
# export RIAK_CORE_DATA_DIR=data
# export HTTP_PORT=8198
# export HANDOFF_PORT=8199
# export COOKIE=magma

# envsubst < etc/dev.config > etc/dev.2.config
# envsubst < etc/vm.args > etc/vm.2.args

# exec erl +P 200000 -pa ebin -pa deps/*/ebin \
#      -setcookie magma -s magma_app start -config etc/dev.2.config -args_file etc/vm.2.args

exec /usr/local/bin/erl -pa {{magma_install_dir}}/magma/lib/*/ebin +Ktrue +B -noinput -config {{magma_config_dir}}/sys.config -name {{node_name}}@{{ip_address}} -setcookie {{cookie}} -boot /usr/lib/erlang/lib/magma/releases/1/magma -shutdown_time 5000 +W w
